<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profitable Trading Bot - Advanced Strategy Optimizer</title>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%);
            color: #ffffff;
            min-height: 100vh;
            padding: 10px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .profitability-banner {
            background: linear-gradient(45deg, #00ff88, #00d4ff);
            color: #0a0e27;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
            font-size: 1.3em;
            box-shadow: 0 4px 20px rgba(0, 255, 136, 0.3);
        }

        .header {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 255, 136, 0.3);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #00ff88, #00d4ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .main-layout {
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .profitability-panel {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            height: fit-content;
            max-height: 80vh;
            overflow-y: auto;
        }

        .trading-area {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .section {
            margin-bottom: 25px;
        }

        .section h3 {
            color: #00ff88;
            margin-bottom: 15px;
            font-size: 1.2em;
            border-bottom: 1px solid rgba(0, 255, 136, 0.3);
            padding-bottom: 5px;
        }

        .profitability-metrics {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .metric-card {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.3);
            border-radius: 10px;
            padding: 12px;
            text-align: center;
        }

        .metric-value {
            font-size: 1.4em;
            font-weight: bold;
            color: #00ff88;
        }

        .metric-label {
            color: #8892b0;
            font-size: 0.8em;
            margin-top: 5px;
        }

        .strategy-optimizer {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .optimizer-title {
            color: #00d4ff;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .parameter-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .parameter-label {
            color: #ffffff;
            font-size: 0.9em;
            flex: 1;
        }

        .parameter-input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            width: 100px;
            text-align: center;
        }

        .profitability-formula {
            background: rgba(0, 212, 255, 0.1);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .formula-title {
            color: #00d4ff;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.95em;
            width: 100%;
            margin-bottom: 10px;
        }

        .btn-profit {
            background: linear-gradient(45deg, #00ff88, #00d4ff);
            color: #0a0e27;
            font-weight: bold;
        }

        .btn-optimize {
            background: linear-gradient(45deg, #00d4ff, #0099ff);
            color: white;
        }

        .btn-test {
            background: linear-gradient(45deg, #ffc107, #ffdb4d);
            color: #0a0e27;
        }

        .btn-danger {
            background: linear-gradient(45deg, #ff4757, #ff6b7a);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .profitability-analysis {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .analysis-item {
            text-align: center;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }

        .analysis-value {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .analysis-label {
            color: #8892b0;
            font-size: 0.8em;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            height: 400px;
        }

        .strategies-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .strategy-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .strategy-card:hover {
            transform: translateY(-3px);
            border-color: #00ff88;
        }

        .strategy-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .strategy-name {
            font-weight: bold;
            color: #00ff88;
        }

        .strategy-profit {
            font-weight: bold;
            font-size: 1.1em;
        }

        .profit-positive {
            color: #00ff88;
        }

        .profit-negative {
            color: #ff4757;
        }

        .recommendation-box {
            background: linear-gradient(45deg, #00ff88, #00d4ff);
            color: #0a0e27;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            font-weight: bold;
        }

        .log-container {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            max-height: 300px;
            overflow-y: auto;
        }

        .log-entry {
            padding: 8px;
            margin: 5px 0;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .log-profit {
            background: rgba(0, 255, 136, 0.1);
            border-left: 3px solid #00ff88;
        }

        .log-warning {
            background: rgba(255, 193, 7, 0.1);
            border-left: 3px solid #ffc107;
        }

        .log-error {
            background: rgba(255, 71, 87, 0.1);
            border-left: 3px solid #ff4757;
        }

        .gas-optimizer {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .slider {
            width: 100%;
            -webkit-appearance: none;
            height: 5px;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.2);
            outline: none;
            margin: 10px 0;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: #00ff88;
            cursor: pointer;
        }

        @media (max-width: 1200px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
            
            .profitability-panel {
                max-height: none;
            }
        }

        @media (max-width: 768px) {
            .profitability-metrics {
                grid-template-columns: 1fr;
            }
            
            .strategies-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body>
    <div class="container">
        <div class="profitability-banner">
            üí∞ PROFITABILITY OPTIMIZER - Advanced Strategy for Real Profits
        </div>

        <div class="header">
            <h1>üß† Profitable Trading Bot</h1>
            <p>Mathematical Approach to Consistent Profit Generation</p>
        </div>

        <div class="main-layout">
            <!-- Left Panel: Profitability Controls -->
            <div class="profitability-panel">
                <div class="section">
                    <h3>üí∞ Profitability Metrics</h3>
                    <div class="profitability-metrics">
                        <div class="metric-card">
                            <div class="metric-value" id="profit-target">+$500</div>
                            <div class="metric-label">Daily Profit Target</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="win-rate">75%</div>
                            <div class="metric-label">Required Win Rate</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="min-trade">$25</div>
                            <div class="metric-label">Minimum Trade Size</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value" id="gas-ratio">20%</div>
                            <div class="metric-label">Max Gas Ratio</div>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h3>üìä Profitability Formula</h3>
                    <div class="profitability-formula">
                        <div class="formula-title">Profit Formula:</div>
                        <div>Net Profit = (Trade Profit √ó Win Rate) - (Trade Loss √ó Loss Rate) - Gas Fees</div>
                        <div style="margin-top: 10px; color: #00ff88;">
                            Required: (Trade Size √ó Profit %) > (Gas Fees √ó 2)
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h3>‚ö° Strategy Optimizer</h3>
                    
                    <div class="strategy-optimizer">
                        <div class="optimizer-title">Trade Size Calculator</div>
                        <div class="parameter-row">
                            <span class="parameter-label">Target Profit ($):</span>
                            <input type="number" class="parameter-input" id="target-profit" value="25" min="10" max="500">
                        </div>
                        <div class="parameter-row">
                            <span class="parameter-label">Gas Cost ($):</span>
                            <input type="number" class="parameter-input" id="gas-cost" value="15" min="5" max="50">
                        </div>
                        <div class="parameter-row">
                            <span class="parameter-label">Win Rate (%):</span>
                            <input type="number" class="parameter-input" id="expected-win-rate" value="70" min="50" max="95">
                        </div>
                        <div style="margin-top: 15px; color: #00ff88; font-size: 0.9em;">
                            Minimum Trade Size: $<span id="calculated-min-trade">45</span>
                        </div>
                    </div>

                    <div class="gas-optimizer">
                        <div class="optimizer-title">Gas Optimization</div>
                        <div class="parameter-row">
                            <span class="parameter-label">Gas Price (Gwei):</span>
                            <input type="number" class="parameter-input" id="gas-price-input" value="20" min="10" max="100">
                        </div>
                        <div class="parameter-row">
                            <span class="parameter-label">Optimal Timing:</span>
                            <select class="parameter-input" id="optimal-timing">
                                <option value="weekend">Weekend (Low Gas)</option>
                                <option value="night">Night (2-4 AM)</option>
                                <option value="weekday">Weekday (High Volume)</option>
                            </select>
                        </div>
                        <div class="parameter-row">
                            <span class="parameter-label">Gas Strategy:</span>
                            <select class="parameter-input" id="gas-strategy">
                                <option value="safe">Safe (Standard)</option>
                                <option value="fast">Fast (+20% cost)</option>
                                <option value="slow">Slow (-30% cost)</option>
                            </select>
                        </div>
                    </div>

                    <div class="strategy-optimizer">
                        <div class="optimizer-title">Risk Management</div>
                        <div class="parameter-row">
                            <span class="parameter-label">Risk per Trade (%):</span>
                            <input type="number" class="parameter-input" id="risk-per-trade" value="2" min="0.5" max="10" step="0.5">
                        </div>
                        <div class="parameter-row">
                            <span class="parameter-label">Max Daily Risk (%):</span>
                            <input type="number" class="parameter-input" id="max-daily-risk" value="10" min="2" max="20">
                        </div>
                        <div class="parameter-row">
                            <span class="parameter-label">Profit Target (%):</span>
                            <input type="number" class="parameter-input" id="profit-target-percent" value="5" min="1" max="20">
                        </div>
                        <div class="parameter-row">
                            <span class="parameter-label">Stop Loss (%):</span>
                            <input type="number" class="parameter-input" id="stop-loss-percent" value="2" min="0.5" max="5">
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h3>üéØ Action Controls</h3>
                    <button class="btn btn-profit" onclick="runProfitabilityAnalysis()">üí∞ Analyze Profitability</button>
                    <button class="btn btn-optimize" onclick="optimizeStrategy()">‚ö° Optimize Strategy</button>
                    <button class="btn btn-test" onclick="testStrategy()">üß™ Test Strategy</button>
                    <button class="btn btn-danger" onclick="emergencyStop()">üõë Emergency Stop</button>
                </div>
            </div>

            <!-- Right Panel: Analysis & Trading -->
            <div class="trading-area">
                <div class="profitability-analysis">
                    <h3>üìà Profitability Analysis</h3>
                    <div id="profitability-summary">
                        <div style="text-align: center; color: #8892b0;">
                            Click "Analyze Profitability" to see detailed analysis
                        </div>
                    </div>
                    <div class="analysis-grid" id="analysis-grid" style="display: none;">
                        <div class="analysis-item">
                            <div class="analysis-value" id="expected-profit">+$0</div>
                            <div class="analysis-label">Expected Daily Profit</div>
                        </div>
                        <div class="analysis-item">
                            <div class="analysis-value" id="breakeven-trades">0</div>
                            <div class="analysis-label">Breakeven Trades/Day</div>
                        </div>
                        <div class="analysis-item">
                            <div class="analysis-value" id="monthly-projection">$0</div>
                            <div class="analysis-label">Monthly Projection</div>
                        </div>
                        <div class="analysis-item">
                            <div class="analysis-value" id="risk-score">0</div>
                            <div class="analysis-label">Risk Score (1-10)</div>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h3>üìä Profitability Chart</h3>
                    <div class="chart-container">
                        <canvas id="profitability-chart"></canvas>
                    </div>
                </div>

                <div class="recommendation-box" id="recommendation-box" style="display: none;">
                    <div id="recommendation-content"></div>
                </div>

                <div class="section">
                    <h3>üß† Profitable Strategies</h3>
                    <div class="strategies-grid" id="strategies-grid">
                        <!-- Strategies will be dynamically generated -->
                    </div>
                </div>

                <div class="section">
                    <h3>üìã Optimization Log</h3>
                    <div class="log-container" id="optimization-log">
                        <div class="log-entry log-profit">üí∞ Profitability Optimizer initialized</div>
                        <div class="log-entry log-warning">‚ö†Ô∏è Ready to analyze trading strategies for maximum profit</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Profitability Optimization Engine
        class ProfitableTradingBot {
            constructor() {
                this.parameters = {
                    targetProfit: 25,
                    gasCost: 15,
                    winRate: 70,
                    riskPerTrade: 2,
                    maxDailyRisk: 10,
                    profitTarget: 5,
                    stopLoss: 2,
                    gasPrice: 20
                };
                
                this.strategies = [
                    {
                        name: "Scalping Strategy",
                        description: "Quick trades, small profits",
                        minTrade: 50,
                        expectedProfit: 3,
                        winRate: 75,
                        dailyTrades: 20,
                        gasImpact: "High"
                    },
                    {
                        name: "Swing Trading",
                        description: "Medium-term position holding",
                        minTrade: 100,
                        expectedProfit: 8,
                        winRate: 65,
                        dailyTrades: 5,
                        gasImpact: "Low"
                    },
                    {
                        name: "Arbitrage Trading",
                        description: "Cross-exchange price differences",
                        minTrade: 200,
                        expectedProfit: 2,
                        winRate: 90,
                        dailyTrades: 10,
                        gasImpact: "Medium"
                    },
                    {
                        name: "Liquidity Mining",
                        description: "Provide liquidity, earn fees",
                        minTrade: 500,
                        expectedProfit: 15,
                        winRate: 85,
                        dailyTrades: 2,
                        gasImpact: "Medium"
                    },
                    {
                        name: "Momentum Trading",
                        description: "Follow strong market trends",
                        minTrade: 150,
                        expectedProfit: 12,
                        winRate: 60,
                        dailyTrades: 8,
                        gasImpact: "Medium"
                    },
                    {
                        name: "Mean Reversion",
                        description: "Bet on price corrections",
                        minTrade: 75,
                        expectedProfit: 4,
                        winRate: 70,
                        dailyTrades: 12,
                        gasImpact: "High"
                    }
                ];
                
                this.chart = null;
                this.initializeUI();
                this.updateCalculations();
            }

            initializeUI() {
                this.renderStrategies();
                this.initializeChart();
                this.setupEventListeners();
            }

            setupEventListeners() {
                // Add real-time calculation updates
                document.getElementById('target-profit').addEventListener('input', () => this.updateCalculations());
                document.getElementById('gas-cost').addEventListener('input', () => this.updateCalculations());
                document.getElementById('expected-win-rate').addEventListener('input', () => this.updateCalculations());
                document.getElementById('risk-per-trade').addEventListener('input', () => this.updateCalculations());
                document.getElementById('profit-target-percent').addEventListener('input', () => this.updateCalculations());
                document.getElementById('stop-loss-percent').addEventListener('input', () => this.updateCalculations());
            }

            updateCalculations() {
                // Get current parameters
                this.parameters.targetProfit = parseFloat(document.getElementById('target-profit').value);
                this.parameters.gasCost = parseFloat(document.getElementById('gas-cost').value);
                this.parameters.winRate = parseFloat(document.getElementById('expected-win-rate').value);
                
                // Calculate minimum trade size for profitability
                const winRateDecimal = this.parameters.winRate / 100;
                const lossRateDecimal = 1 - winRateDecimal;
                
                // Formula: (Trade √ó Profit% √ó WinRate) > Gas √ó 2
                const profitTarget = 0.05; // 5% profit target
                const minTrade = (this.parameters.gasCost * 2) / (profitTarget * winRateDecimal);
                
                document.getElementById('calculated-min-trade').textContent = Math.ceil(minTrade);
                document.getElementById('min-trade').textContent = `$${Math.ceil(minTrade)}`;
                
                // Update win rate display
                document.getElementById('win-rate').textContent = `${this.parameters.winRate}%`;
                
                // Update profit target
                document.getElementById('profit-target').textContent = `+$${this.parameters.targetProfit}`;
                
                // Update gas ratio
                const gasRatio = (this.parameters.gasCost / minTrade) * 100;
                document.getElementById('gas-ratio').textContent = `${gasRatio.toFixed(1)}%`;
            }

            runProfitabilityAnalysis() {
                this.addLogEntry('üîç Running comprehensive profitability analysis...', 'profit');
                
                // Get strategy parameters
                const minTrade = parseFloat(document.getElementById('calculated-min-trade').textContent);
                const dailyTrades = 10; // Assumed daily trades
                const winRate = this.parameters.winRate / 100;
                const lossRate = 1 - winRate;
                
                // Calculate metrics
                const avgWin = this.parameters.targetProfit;
                const avgLoss = this.parameters.stopLoss * (minTrade / 100);
                const dailyGasCost = this.parameters.gasCost * dailyTrades;
                
                const expectedDailyProfit = (avgWin * dailyTrades * winRate) - (avgLoss * dailyTrades * lossRate) - dailyGasCost;
                const monthlyProjection = expectedDailyProfit * 22; // Trading days
                
                const breakevenTrades = Math.ceil(dailyGasCost / (avgWin * winRate - avgLoss * lossRate));
                const riskScore = Math.min(10, Math.max(1, (this.parameters.riskPerTrade * 2) + (breakevenTrades / 2)));
                
                // Update display
                document.getElementById('profitability-summary').innerHTML = `
                    <div style="text-align: center;">
                        <div style="font-size: 1.2em; margin-bottom: 15px;">Analysis Complete</div>
                        <div>With your current parameters, you need <strong>${breakevenTrades}</strong> winning trades per day to break even.</div>
                    </div>
                `;
                
                document.getElementById('analysis-grid').style.display = 'grid';
                document.getElementById('expected-profit').textContent = expectedDailyProfit >= 0 ? `+$${expectedDailyProfit.toFixed(2)}` : `-$${Math.abs(expectedDailyProfit).toFixed(2)}`;
                document.getElementById('expected-profit').style.color = expectedDailyProfit >= 0 ? '#00ff88' : '#ff4757';
                document.getElementById('breakeven-trades').textContent = breakevenTrades;
                document.getElementById('monthly-projection').textContent = `$${monthlyProjection.toFixed(0)}`;
                document.getElementById('monthly-projection').style.color = monthlyProjection >= 0 ? '#00ff88' : '#ff4757';
                document.getElementById('risk-score').textContent = riskScore.toFixed(1);
                document.getElementById('risk-score').style.color = riskScore <= 5 ? '#00ff88' : riskScore <= 7 ? '#ffc107' : '#ff4757';
                
                // Generate recommendations
                this.generateRecommendations(expectedDailyProfit, breakevenTrades, riskScore);
                
                // Update chart
                this.updateProfitabilityChart(minTrade, expectedDailyProfit);
                
                this.addLogEntry(`‚úÖ Analysis complete: Expected daily profit: $${expectedDailyProfit.toFixed(2)}`, expectedDailyProfit >= 0 ? 'profit' : 'error');
            }

            generateRecommendations(expectedProfit, breakevenTrades, riskScore) {
                const recommendations = [];
                
                if (expectedProfit < 0) {
                    recommendations.push("‚ùå Current parameters will lose money. Increase trade size or win rate.");
                } else if (expectedProfit < 50) {
                    recommendations.push("‚ö†Ô∏è Low profit margin. Consider increasing trade size or reducing gas costs.");
                } else {
                    recommendations.push("‚úÖ Profitable configuration detected!");
                }
                
                if (breakevenTrades > 15) {
                    recommendations.push("üìä High breakeven threshold. Reduce costs or increase profit per trade.");
                }
                
                if (riskScore > 7) {
                    recommendations.push("‚ö†Ô∏è High risk score. Reduce position sizes or increase win rate target.");
                }
                
                if (this.parameters.gasCost > 20) {
                    recommendations.push("‚õΩ High gas costs. Trade during off-peak hours for better profitability.");
                }
                
                // Strategy recommendation
                let bestStrategy = this.strategies[0];
                let bestScore = 0;
                
                for (const strategy of this.strategies) {
                    const score = this.calculateStrategyScore(strategy);
                    if (score > bestScore) {
                        bestScore = score;
                        bestStrategy = strategy;
                    }
                }
                
                recommendations.push(`üéØ Recommended: ${bestStrategy.name} - ${bestStrategy.description}`);
                
                const recommendationBox = document.getElementById('recommendation-box');
                const recommendationContent = document.getElementById('recommendation-content');
                
                recommendationContent.innerHTML = `
                    <h4 style="margin-bottom: 15px;">üí° Optimized Recommendations:</h4>
                    ${recommendations.map(rec => `<div style="margin: 8px 0;">‚Ä¢ ${rec}</div>`).join('')}
                    <div style="margin-top: 15px; font-size: 0.9em;">
                        <strong>Quick Win:</strong> Trade during weekends when gas is 30-50% cheaper
                    </div>
                `;
                
                recommendationBox.style.display = 'block';
            }

            calculateStrategyScore(strategy) {
                // Score based on profitability vs risk
                const profitScore = (strategy.expectedProfit * strategy.winRate) - (strategy.minTrade * 0.02);
                const riskScore = strategy.dailyTrades * (strategy.gasImpact === 'High' ? 2 : strategy.gasImpact === 'Medium' ? 1 : 0.5);
                return profitScore - riskScore;
            }

            optimizeStrategy() {
                this.addLogEntry('‚ö° Running strategy optimization algorithm...', 'profit');
                
                // Optimize for maximum profitability
                const optimalMinTrade = Math.max(50, this.parameters.gasCost * 3);
                const optimalWinRate = Math.min(85, this.parameters.winRate + 10);
                const optimalRisk = Math.max(1, this.parameters.riskPerTrade - 0.5);
                
                // Update UI with optimized values
                document.getElementById('calculated-min-trade').textContent = optimalMinTrade;
                document.getElementById('min-trade').textContent = `$${optimalMinTrade}`;
                document.getElementById('expected-win-rate').value = optimalWinRate;
                document.getElementById('risk-per-trade').value = optimalRisk;
                
                this.parameters.winRate = optimalWinRate;
                this.parameters.riskPerTrade = optimalRisk;
                
                this.addLogEntry(`‚úÖ Strategy optimized: Min trade $${optimalMinTrade}, Win rate ${optimalWinRate}%`, 'profit');
                
                // Re-run analysis with optimized parameters
                setTimeout(() => this.runProfitabilityAnalysis(), 1000);
            }

            testStrategy() {
                this.addLogEntry('üß™ Running strategy simulation...', 'profit');
                
                // Simulate 30 days of trading
                const days = 30;
                const tradesPerDay = 8;
                let totalProfit = 0;
                let winningDays = 0;
                
                const profitData = [];
                
                for (let day = 0; day < days; day++) {
                    let dailyProfit = 0;
                    
                    for (let trade = 0; trade < tradesPerDay; trade++) {
                        const isWin = Math.random() < (this.parameters.winRate / 100);
                        const profitAmount = isWin ? 
                            this.parameters.targetProfit : 
                            -this.parameters.stopLoss * 2;
                        
                        dailyProfit += profitAmount - this.parameters.gasCost;
                    }
                    
                    totalProfit += dailyProfit;
                    if (dailyProfit > 0) winningDays++;
                    profitData.push(totalProfit);
                }
                
                const avgDailyProfit = totalProfit / days;
                const winRatePercent = (winningDays / days) * 100;
                
                this.addLogEntry(`üìä 30-day simulation: Daily avg $${avgDailyProfit.toFixed(2)}, Win rate ${winRatePercent.toFixed(1)}%`, avgDailyProfit > 0 ? 'profit' : 'error');
                
                // Update chart with simulation data
                this.updateSimulationChart(profitData);
            }

            renderStrategies() {
                const container = document.getElementById('strategies-grid');
                container.innerHTML = '';
                
                this.strategies.forEach(strategy => {
                    const card = this.createStrategyCard(strategy);
                    container.appendChild(card);
                });
            }

            createStrategyCard(strategy) {
                const card = document.createElement('div');
                card.className = 'strategy-card';
                
                const score = this.calculateStrategyScore(strategy);
                const dailyProfit = (strategy.expectedProfit * strategy.dailyTrades * strategy.winRate / 100) - (this.parameters.gasCost * strategy.dailyTrades);
                
                card.innerHTML = `
                    <div class="strategy-header">
                        <div class="strategy-name">${strategy.name}</div>
                        <div class="strategy-profit ${dailyProfit >= 0 ? 'profit-positive' : 'profit-negative'}">
                            ${dailyProfit >= 0 ? '+' : ''}$${dailyProfit.toFixed(0)}/day
                        </div>
                    </div>
                    <div style="color: #8892b0; font-size: 0.9em; margin-bottom: 10px;">${strategy.description}</div>
                    <div style="font-size: 0.85em; color: #8892b0;">
                        <div>Min Trade: $${strategy.minTrade}</div>
                        <div>Win Rate: ${strategy.winRate}%</div>
                        <div>Daily Trades: ${strategy.dailyTrades}</div>
                        <div>Gas Impact: ${strategy.gasImpact}</div>
                        <div style="margin-top: 8px; color: #00d4ff;">
                            Score: ${score.toFixed(1)}/10
                        </div>
                    </div>
                `;
                
                return card;
            }

            initializeChart() {
                const ctx = document.getElementById('profitability-chart').getContext('2d');
                this.chart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [{
                            label: 'Profit Projection',
                            data: [],
                            borderColor: '#00ff88',
                            backgroundColor: 'rgba(0, 255, 136, 0.1)',
                            borderWidth: 2,
                            fill: true,
                            tension: 0.1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: true,
                                labels: { color: '#ffffff' }
                            }
                        },
                        scales: {
                            x: {
                                ticks: { color: '#8892b0' },
                                grid: { color: 'rgba(255, 255, 255, 0.1)' }
                            },
                            y: {
                                ticks: { color: '#8892b0' },
                                grid: { color: 'rgba(255, 255, 255, 0.1)' }
                            }
                        }
                    }
                });
            }

            updateProfitabilityChart(minTrade, dailyProfit) {
                if (!this.chart) return;
                
                const days = Array.from({length: 30}, (_, i) => `Day ${i + 1}`);
                const profits = [];
                let cumulative = 0;
                
                for (let i = 0; i < 30; i++) {
                    cumulative += dailyProfit;
                    profits.push(cumulative);
                }
                
                this.chart.data.labels = days;
                this.chart.data.datasets[0].data = profits;
                this.chart.update();
            }

            updateSimulationChart(profitData) {
                if (!this.chart) return;
                
                const days = Array.from({length: profitData.length}, (_, i) => `Day ${i + 1}`);
                
                this.chart.data.labels = days;
                this.chart.data.datasets[0].data = profitData;
                this.chart.update();
            }

            emergencyStop() {
                this.addLogEntry('üõë Emergency stop activated - All optimization halted', 'error');
            }

            addLogEntry(message, type = 'profit') {
                const logContainer = document.getElementById('optimization-log');
                const entry = document.createElement('div');
                entry.className = `log-entry log-${type}`;
                
                const timestamp = new Date().toLocaleTimeString();
                entry.textContent = `[${timestamp}] ${message}`;
                
                logContainer.appendChild(entry);
                logContainer.scrollTop = logContainer.scrollHeight;

                // Keep only last 50 entries
                while (logContainer.children.length > 50) {
                    logContainer.removeChild(logContainer.firstChild);
                }
            }
        }

        // Global functions
        let bot;

        function runProfitabilityAnalysis() {
            bot.runProfitabilityAnalysis();
        }

        function optimizeStrategy() {
            bot.optimizeStrategy();
        }

        function testStrategy() {
            bot.testStrategy();
        }

        function emergencyStop() {
            bot.emergencyStop();
        }

        // Initialize bot when page loads
        document.addEventListener('DOMContentLoaded', function() {
            bot = new ProfitableTradingBot();
        });
    </script>
</body>
</html>
